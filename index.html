<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta
          name="viewport"
          content="initial-scale=1,maximum-scale=1,user-scalable=no"
  />
  <title>OpenStreetMapLayer - 4.12</title>

  <style>
    html,
    body,
    #viewDiv {
      padding: 0;
      margin: 0;
      height: 100%;
      width: 100%;
    }

    #overviewDiv {
      position: absolute;
      bottom: 12px;
      left: 12px;
      width: 300px;
      height: 200px;
      border: 1px solid black;
      z-index: 1;
      overflow: hidden;
    }

    #extentDiv {
      background-color: rgba(0,0,0,0.5);
      position: absolute;
      z-index: 2;
    }
  </style>

  <link
          rel="stylesheet"
          href="https://js.arcgis.com/4.12/esri/themes/light/main.css"
  />
  <script src="https://js.arcgis.com/4.12/"></script>

  <script>
    require(["esri/views/SceneView", "esri/WebScene", "esri/Map", "esri/views/MapView", "esri/core/watchUtils","esri/geometry/Point", "dojo/ready"], function(
            SceneView,
            WebScene,
            Map,
            MapView,
            watchUtils,
            Point,
            ready
    ) {
      ready(function(){
        var scene = new WebScene({
          portalItem: {
            id: "c1fa39dddfab4ced9a225d938e0df2a5"
          }
        });

        var view = new SceneView({
          map: scene,
          container: "viewDiv",
          padding: {
            top: 40
          }
        });

        var overviewMap = new Map({
          basemap: "topo"
        });

        var mapView = new MapView({
          container: "overviewDiv",
          map: overviewMap,
          constraints: {
            rotationEnabled: false
          }
        });
        
        mapView.ui.components = [];

        var extentDiv = document.getElementById("extentDiv");

        view.when(function(){
          mapView.when(function(){
            view.watch("extent", updateOverviewExtent);
            mapView.watch("extent",updateOverviewExtent);

            watchUtils.when(view, "stationary", updateOverview);

            function updateOverview(){
              mapView.goTo({
                center: view.center,
                scale: view.scale*2*Math.max(view.width/mapView.width, view.height/mapView.height)
              });
            }

            function updateOverviewExtent(){
              var extent = view.extent;

              var bottomLeft = mapView.toScreen(
                      new Point({
                        x: extent.xmin,
                        y: extent.ymin,
                        spatialReference: extent.spatialReference
                      })
              );

              var topRight = mapView.toScreen(
                      new Point({
                        x: extent.xmax,
                        y: extent.ymax,
                        spatialReference: extent.spatialReference
                      })
              );

              extentDiv.style.top = topRight.y + "px";
              extentDiv.style.left = bottomLeft.x + "px";

              extentDiv.style.height = bottomLeft.y - topRight.y + "px";
              extentDiv.style.width = topRight.x - bottomLeft.x + "px";
            }
          });
          var title = scene.portalItem.title;
          titleDiv.innerHTML = title;
        });
      });
    });
  </script>
</head>

<body>
<div id="viewDiv"></div>
<div id="overviewDiv"><div id = "extentDiv"></div></div>
</body>
</html>
